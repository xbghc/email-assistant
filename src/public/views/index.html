<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>邮件助手管理界面</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
    <div class="app">
        <!-- 侧边栏导航 -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2><i data-feather="mail"></i>邮件助手</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-page="dashboard">
                    <a href="#"><i data-feather="home"></i>仪表板</a>
                </li>
                <li class="nav-item" data-page="users">
                    <a href="#"><i data-feather="users"></i>用户管理</a>
                </li>
                <li class="nav-item" data-page="system">
                    <a href="#"><i data-feather="activity"></i>系统状态</a>
                </li>
                <li class="nav-item" data-page="reports">
                    <a href="#"><i data-feather="file-text"></i>报告管理</a>
                </li>
                <li class="nav-item" data-page="logs">
                    <a href="#"><i data-feather="list"></i>日志查看</a>
                </li>
                <li class="nav-item" data-page="settings">
                    <a href="#"><i data-feather="settings"></i>系统配置</a>
                </li>
            </ul>
        </nav>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 头部 -->
            <header class="header">
                <h1 id="page-title">仪表板</h1>
                <div class="header-actions">
                    <button class="btn btn-outline" id="refresh-btn">
                        <i data-feather="refresh-cw"></i> 刷新
                    </button>
                    <div class="status-indicator">
                        <span class="status-dot" id="system-status"></span>
                        <span id="status-text">检查中...</span>
                    </div>
                </div>
            </header>

            <!-- 页面内容容器 -->
            <div class="content">
                <!-- 仪表板页面 -->
                <div id="dashboard-page" class="page active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i data-feather="users"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="total-users">-</h3>
                                <p>活跃用户</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i data-feather="mail"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="emails-sent">-</h3>
                                <p>今日邮件</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i data-feather="file-text"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="reports-generated">-</h3>
                                <p>本周报告</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i data-feather="cpu"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="system-uptime">-</h3>
                                <p>系统运行时间</p>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3>快速操作</h3>
                            </div>
                            <div class="card-content">
                                <div class="quick-actions">
                                    <button class="btn btn-primary" onclick="testMorningReminder()">
                                        <i data-feather="sunrise"></i> 测试晨间提醒
                                    </button>
                                    <button class="btn btn-primary" onclick="testEveningReminder()">
                                        <i data-feather="sunset"></i> 测试晚间提醒
                                    </button>
                                    <button class="btn btn-secondary" onclick="generateWeeklyReport()">
                                        <i data-feather="file-text"></i> 生成周报
                                    </button>
                                    <button class="btn btn-secondary" onclick="generateSuggestions()">
                                        <i data-feather="lightbulb"></i> 生成建议
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3>系统健康状况</h3>
                            </div>
                            <div class="card-content">
                                <div class="health-metrics">
                                    <div class="metric">
                                        <span class="metric-label">API服务</span>
                                        <span class="metric-value" id="api-status">检查中...</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">邮件服务</span>
                                        <span class="metric-value" id="email-status">检查中...</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">调度器</span>
                                        <span class="metric-value" id="scheduler-status">检查中...</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">AI服务</span>
                                        <span class="metric-value" id="ai-status">检查中...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 用户管理页面 -->
                <div id="users-page" class="page">
                    <div class="page-header">
                        <h2>用户管理</h2>
                        <button class="btn btn-primary" onclick="showAddUserModal()">
                            <i data-feather="plus"></i> 添加用户
                        </button>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div class="table-container">
                                <table id="users-table" class="data-table">
                                    <thead>
                                        <tr>
                                            <th>用户ID</th>
                                            <th>姓名</th>
                                            <th>邮箱</th>
                                            <th>状态</th>
                                            <th>创建时间</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="users-table-body">
                                        <tr>
                                            <td colspan="6" class="loading">加载中...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 系统状态页面 -->
                <div id="system-page" class="page">
                    <div class="page-header">
                        <h2>系统状态监控</h2>
                    </div>
                    <div class="system-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3>服务状态</h3>
                            </div>
                            <div class="card-content">
                                <div id="services-status" class="services-list">
                                    <!-- 动态生成服务状态 -->
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3>性能指标</h3>
                            </div>
                            <div class="card-content">
                                <div id="performance-metrics" class="metrics-list">
                                    <!-- 动态生成性能指标 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 报告管理页面 -->
                <div id="reports-page" class="page">
                    <div class="page-header">
                        <h2>报告管理</h2>
                        <div class="header-controls">
                            <select id="report-type" class="form-select">
                                <option value="weekly">周报</option>
                                <option value="suggestions">个性化建议</option>
                            </select>
                            <button class="btn btn-primary" onclick="generateReports()">
                                <i data-feather="play"></i> 生成报告
                            </button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div id="reports-list" class="reports-container">
                                <!-- 动态生成报告列表 -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 日志查看页面 -->
                <div id="logs-page" class="page">
                    <div class="page-header">
                        <h2>系统日志</h2>
                        <div class="header-controls">
                            <select id="log-level" class="form-select">
                                <option value="all">所有级别</option>
                                <option value="error">错误</option>
                                <option value="warn">警告</option>
                                <option value="info">信息</option>
                                <option value="debug">调试</option>
                            </select>
                            <button class="btn btn-outline" onclick="refreshLogs()">
                                <i data-feather="refresh-cw"></i> 刷新
                            </button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-content">
                            <div id="logs-container" class="logs-viewer">
                                <div class="loading">加载日志中...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 系统配置页面 -->
                <div id="settings-page" class="page">
                    <div class="page-header">
                        <h2>系统配置</h2>
                        <button class="btn btn-success" onclick="saveSettings()">
                            <i data-feather="save"></i> 保存配置
                        </button>
                    </div>
                    <div class="settings-grid">
                        <div class="card">
                            <div class="card-header">
                                <h3>邮件配置</h3>
                            </div>
                            <div class="card-content">
                                <form id="email-settings-form" class="form">
                                    <div class="form-group">
                                        <label for="smtp-host">SMTP主机</label>
                                        <input type="text" id="smtp-host" class="form-input" placeholder="smtp.example.com">
                                    </div>
                                    <div class="form-group">
                                        <label for="smtp-port">SMTP端口</label>
                                        <input type="number" id="smtp-port" class="form-input" placeholder="587">
                                    </div>
                                    <div class="form-group">
                                        <label for="email-user">邮箱用户名</label>
                                        <input type="email" id="email-user" class="form-input" placeholder="user@example.com">
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h3>AI配置</h3>
                            </div>
                            <div class="card-content">
                                <form id="ai-settings-form" class="form">
                                    <div class="form-group">
                                        <label for="ai-provider">AI提供商</label>
                                        <select id="ai-provider" class="form-select">
                                            <option value="openai">OpenAI</option>
                                            <option value="deepseek">DeepSeek</option>
                                            <option value="google">Google</option>
                                            <option value="anthropic">Anthropic</option>
                                            <option value="mock">Mock (测试)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="ai-model">AI模型</label>
                                        <input type="text" id="ai-model" class="form-input" placeholder="gpt-3.5-turbo">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 模态框 -->
    <div id="add-user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>添加新用户</h3>
                <button class="modal-close" onclick="closeModal('add-user-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="add-user-form" class="form">
                    <div class="form-group">
                        <label for="user-name">用户姓名</label>
                        <input type="text" id="user-name" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="user-email">邮箱地址</label>
                        <input type="email" id="user-email" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="user-timezone">时区</label>
                        <select id="user-timezone" class="form-select">
                            <option value="Asia/Shanghai">亚洲/上海</option>
                            <option value="America/New_York">美国/纽约</option>
                            <option value="Europe/London">欧洲/伦敦</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('add-user-modal')">取消</button>
                <button class="btn btn-primary" onclick="addUser()">添加用户</button>
            </div>
        </div>
    </div>

    <!-- 加载中覆盖层 -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner"></div>
        <p>处理中...</p>
    </div>

    <!-- 通知容器 -->
    <div id="notifications" class="notifications-container"></div>

    <script src="/js/app.js"></script>
    <script>
        feather.replace();
    </script>
</body>
</html>